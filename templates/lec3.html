<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lecture 3 ‚Äì Exceptions & Error Handling ‚ú®</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt-stdlib.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap");

      :root {
        --bg: #ffffff;
        --text: #1f2937;
        --accent: #0d9488;
        --accent-dark: #115e59;
        --surface: #f9fafb;
        --border: #e5e7eb;

        /* Modern Tech Brand Colors */
        --primary-600: #3b82f6;
        --primary-700: #2563eb;
        --primary-800: #1d4ed8;
        --secondary-600: #6366f1;
        --secondary-700: #4f46e5;
        --secondary-800: #4338ca;
        --accent-500: #10b981;
        --accent-600: #059669;
        --slate-50: #f8fafc;
        --slate-100: #f1f5f9;
        --slate-200: #e2e8f0;
        --slate-300: #cbd5e1;
        --slate-400: #94a3b8;
        --slate-600: #475569;
        --slate-700: #334155;
        --slate-800: #1e293b;
        --slate-900: #0f172a;
        --white: #ffffff;
      }
      [data-theme="dark"] {
        --bg: #0f172a;
        --text: #f1f5f9;
        --surface: #1e293b;
        --border: #334155;

        --primary-600: #2dd4bf;
        --primary-700: #14b8a6;
        --primary-800: #0d9488;
        --secondary-600: #fb923c;
        --secondary-700: #f97316;
        --secondary-800: #ea580c;
        --accent-500: #4ade80;
        --slate-50: #0b1120;
        --slate-100: #111827;
        --slate-200: #1f2937;
        --slate-300: #374151;
        --slate-400: #4b5563;
        --slate-600: #9ca3af;
        --slate-700: #d1d5db;
        --slate-800: #e5e7eb;
        --slate-900: #f9fafb;
        --white: #0b1120;
      }

      /* Premium Navigation */
      .nav-glassmorphism {
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        position: sticky;
        top: 0;
        z-index: 1000;
      }

      .nav-link {
        position: relative;
        font-weight: 500;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .nav-link::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(
          90deg,
          var(--primary-600),
          var(--secondary-600)
        );
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .nav-link:hover::after,
      .nav-link.active::after {
        transform: scaleX(1);
      }

      .nav-link.active {
        color: var(--primary-600);
        font-weight: 600;
      }

      .text-gradient {
        background: linear-gradient(
          135deg,
          var(--primary-600),
          var(--secondary-600)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Section Completion Checkbox */
      .section-complete {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-top: 16px;
        padding: 12px 16px;
        background: var(--slate-50);
        border-radius: 12px;
        border: 2px solid var(--slate-200);
        transition: all 0.3s ease;
      }

      .section-complete:hover {
        border-color: var(--primary-600);
        background: rgba(59, 130, 246, 0.05);
      }

      .section-complete.completed {
        background: rgba(16, 185, 129, 0.1);
        border-color: var(--accent-500);
      }

      .section-checkbox {
        width: 24px;
        height: 24px;
        cursor: pointer;
        accent-color: var(--primary-600);
        flex-shrink: 0;
      }

      .section-checkbox-label {
        font-weight: 600;
        color: var(--slate-700);
        cursor: pointer;
        user-select: none;
        flex: 1;
      }

      .section-complete.completed .section-checkbox-label {
        color: var(--accent-600);
      }

      .xp-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 12px;
        background: linear-gradient(
          135deg,
          var(--primary-600),
          var(--secondary-600)
        );
        color: white;
        border-radius: 20px;
        font-size: 0.875rem;
        font-weight: 600;
        margin-left: auto;
      }

      .xp-badge.earned {
        animation: xpPop 0.5s ease;
      }

      @keyframes xpPop {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
      }
      body {
        font-family: "Inter", sans-serif;
        background: var(--bg);
        color: var(--text);
        transition: background 0.3s, color 0.3s;
      }
      .code-box {
        background: #1e293b;
        color: #e2e8f0;
        border-radius: 0.75rem;
        padding: 1.25rem;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.95rem;
        position: relative;
        overflow: hidden;
      }
      .output-box {
        background: #0f172a;
        color: #10b981;
        border-radius: 0.75rem;
        padding: 1.25rem;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.95rem;
        min-height: 3rem;
        white-space: pre-wrap;
      }
      /* copy button */
      .copy-btn {
        position: absolute;
        top: 0.75rem;
        right: 0.75rem;
        padding: 0.25rem 0.5rem;
        font-size: 0.75rem;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        border-radius: 0.5rem;
        cursor: pointer;
        transition: background 0.2s;
      }
      .copy-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }
      /* scroll-reveal animation helper */
      .reveal {
        opacity: 0;
        transform: translateY(30px);
      }
      /* tiny bounce for cta */
      @keyframes bounce-once {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-8px);
        }
      }
      .bounce {
        animation: bounce-once 0.6s ease;
      }
      /* celebration checkmark */
      .check-celebration {
        display: inline-block;
        transform: scale(0);
        animation: pop 0.4s forwards;
      }
      @keyframes pop {
        to {
          transform: scale(1.2);
        }
      }

      /* Text-to-Speech Styles */
      .tts-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        background: var(--bg);
        border: 2px solid var(--accent);
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        padding: 16px;
        min-width: 280px;
        max-width: 400px;
        transition: transform 0.3s ease, opacity 0.3s ease;
      }

      .tts-container.collapsed {
        transform: translateY(calc(100% - 60px));
      }

      .tts-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        cursor: pointer;
      }

      .tts-title {
        font-weight: 600;
        color: var(--accent);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .tts-controls {
        display: flex;
        gap: 8px;
        margin-bottom: 12px;
        flex-wrap: wrap;
      }

      .tts-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 8px;
        background: var(--accent);
        color: white;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .tts-btn:hover {
        background: var(--accent-dark);
        transform: translateY(-2px);
      }

      .tts-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .tts-btn.secondary {
        background: var(--surface);
        color: var(--text);
        border: 1px solid var(--border);
      }

      .tts-btn.secondary:hover {
        background: var(--border);
      }

      .tts-speed-control {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 8px;
        font-size: 14px;
      }

      .tts-speed-slider {
        flex: 1;
        height: 6px;
        border-radius: 3px;
        background: var(--border);
        outline: none;
        -webkit-appearance: none;
      }

      .tts-speed-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: var(--accent);
        cursor: pointer;
      }

      .tts-speed-slider::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: var(--accent);
        cursor: pointer;
        border: none;
      }

      .tts-status {
        font-size: 12px;
        color: var(--text);
        opacity: 0.7;
        margin-top: 8px;
        text-align: center;
      }

      .tts-reading {
        background: rgba(13, 148, 136, 0.1);
        border-left: 3px solid var(--accent);
        padding-left: 8px;
        transition: all 0.3s;
      }

      @media (max-width: 640px) {
        .tts-container {
          bottom: 10px;
          right: 10px;
          left: 10px;
          max-width: none;
        }
      }
    </style>
    <base target="_blank" />
  </head>
  <body>
    <nav class="sticky top-0 z-40 bg-teal-700 text-white shadow-lg">
      <div
        class="max-w-5xl mx-auto px-4 h-16 flex items-center justify-between"
      >
        <div class="text-2xl font-bold flex items-center gap-2">
          <span class="hidden sm:inline">üêç</span> PythonLearn
        </div>
        <a href="/course" class="text-sm sm:text-base hover:underline"
          >‚Üê Back to Course</a
        >
      </div>
    </nav>

    <div class="mini-nav">
      <div
        class="max-w-5xl mx-auto px-4 py-3 flex flex-wrap gap-2 justify-center"
      >
        <a
          href="/lec0"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 0</a
        >
        <a
          href="/lec1"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 1</a
        >
        <a
          href="/lec2"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 2</a
        >
        <a
          href="/lec3"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 3</a
        >
        <a
          href="/lec4"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 4</a
        >
        <a
          href="/lec5"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 5</a
        >
        <a
          href="/lec6"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 6</a
        >
        <a
          href="/lec7"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 7</a
        >
        <a
          href="/lec8"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 8</a
        >
        <a
          href="/lec9"
          class="px-4 py-2 rounded-full bg-emerald-400 hover:bg-emerald-500"
          >Lecture 9</a
        >
      </div>
    </div>

    <main class="max-w-4xl mx-auto px-4 py-10">
      <header class="reveal mb-12 text-center">
        <h1
          class="text-4xl sm:text-5xl font-extrabold mb-3 bg-clip-text text-transparent bg-gradient-to-r from-teal-600 to-blue-500"
        >
          Lecture 3 ‚Äì Exceptions & Error Handling
        </h1>
        <p class="text-lg text-gray-600 dark:text-gray-300">
          Make your programs bullet-proof by catching (and fixing) runtime
          problems.
        </p>
      </header>

      <!-- 1. Exceptions (verbatim text) -->
      <section class="reveal mb-12" data-section-id="lec3-section-1">
        <h2 class="text-2xl font-bold mb-3 flex items-center gap-2">
          <span>üö®</span> Exceptions
        </h2>
        <p class="mb-4">
          Exceptions are things that go wrong within our coding. Exceptions are
          problems that arise while your program is running.
        </p>
        <p class="mb-4">
          In our text editor, type code hello.py to create a new file. Type as
          follows (with the intentional errors included):
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button
          >print("hello, world)
        </div>
        <p class="mt-4">
          Notice that we intentionally left out a quotation mark.
        </p>
        <p class="mt-4">
          Running python hello.py in the terminal produces an error. The
          interpreter reports a syntax error. Syntax errors generally mean you
          should double-check that you typed your code correctly.
        </p>
        <p class="mt-4">
          You can learn more in Python‚Äôs documentation of Errors and Exceptions.
        </p>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-1">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-1"
            data-section-id="lec3-section-1"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-1" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-1">+10 XP</span>
        </div>
      </section>

      <!-- 2. Runtime Errors (verbatim text) -->
      <section class="reveal mb-12" data-section-id="lec3-section-2">
        <h2 class="text-2xl font-bold mb-3 flex items-center gap-2">
          <span>‚ö†Ô∏è</span> Runtime Errors
        </h2>
        <p class="mb-4">
          Runtime errors refer to those created by unexpected behavior within
          your code. For example, perhaps you intended for a user to input a
          number, but they input a character instead. Your program may throw an
          error because of this unexpected input from the user.
        </p>
        <p class="mb-4">
          In your terminal window, run code number.py. Code as follows in your
          text editor:
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>x =
          int(input("What's x? ")) print(f"x is {x}")
        </div>
        <p class="mt-4">
          Notice that by including the f, we tell Python to interpolate what is
          in the curly braces as the value of x. Further, testing out your code,
          you can imagine how one could easily type in a string or a character
          instead of a number. Even still, a user could type nothing at all ‚Äì
          simply hitting the enter key.
        </p>
        <p class="mt-4">
          As programmers, we should be defensive to ensure that our users are
          entering what we expected.
        </p>
        <p class="mt-4">
          If we run this program and type ‚Äúcat‚Äù, we‚Äôll see ValueError: invalid
          literal for int() with base 10: 'cat'. In other words, the int
          function cannot convert the text ‚Äúcat‚Äù into a number.
        </p>
        <p class="mt-4">
          An effective strategy to fix this potential error would be to create
          ‚Äúerror handling‚Äù to ensure the user behaves as we intend.
        </p>
        <p class="mt-4">
          You can learn more in Python‚Äôs documentation of Errors and Exceptions.
        </p>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-2">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-2"
            data-section-id="lec3-section-2"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-2" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-2">+10 XP</span>
        </div>
      </section>

      <!-- 3. try (verbatim text) -->
      <section class="reveal mb-12" data-section-id="lec3-section-3">
        <h2 class="text-2xl font-bold mb-3 flex items-center gap-2">
          <span>üõ°Ô∏è</span> try
        </h2>
        <p class="mb-4">
          In Python try and except are ways of testing out user input before
          something goes wrong. Modify your code as follows:
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>try: x
          = int(input("What's x?")) print(f"x is {x}") except ValueError:
          print("x is not an integer")
        </div>
        <p class="mt-4">
          Notice that, running this code, inputting 50 will be accepted.
          However, typing in cat will produce an error visible to the user,
          instructing them why their input was not accepted.
        </p>
        <p class="mt-4">
          This is still not the best way to implement this code. Notice that we
          are trying to do two lines of code. For best practice, we should only
          try the fewest lines of code possible that we are concerned could
          fail. Adjust your code as follows:
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>try: x
          = int(input("What's x?")) except ValueError: print("x is not an
          integer") print(f"x is {x}")
        </div>
        <p class="mt-4">
          Notice that while this accomplishes our goal of trying as few lines as
          possible, we now face a new error! We face a NameError where x is not
          defined. Look at this code and consider: Why is x not defined in some
          cases?
        </p>
        <p class="mt-4">
          Indeed, if you examine the order of operations in x =
          int(input("What's x?")), working right to left, it could take an
          incorrectly inputted character and attempt to assign it as an integer.
          If this fails, the assignment of the value of x never occurs.
          Therefore, there is no x to print on our final line of code.
        </p>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-3">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-3"
            data-section-id="lec3-section-3"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-3" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-3">+10 XP</span>
        </div>
      </section>

      <!-- 4. else (verbatim text) -->
      <section class="reveal mb-12" data-section-id="lec3-section-4">
        <h2 class="text-2xl font-bold mb-3 flex items-center gap-2">
          <span>‚úÖ</span> else
        </h2>
        <p class="mb-4">
          It turns out that there is another way to implement try that could
          catch errors of this nature.
        </p>
        <p class="mb-4">Adjust your code as follows:</p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>try: x
          = int(input("What's x?")) except ValueError: print("x is not an
          integer") else: print(f"x is {x}")
        </div>
        <p class="mt-4">
          Notice that if no exception occurs, it will then run the block of code
          within else. Running python number.py and supplying 50, you‚Äôll notice
          that the result will be printed. Trying again, this time supplying
          cat, you‚Äôll notice that the program now catches the error.
        </p>
        <p class="mt-4">
          Considering improving our code, notice that we are being a bit rude to
          our user. If our user does not cooperate, we currently simply end our
          program. Consider how we can use a loop to prompt the user for x and
          if they don‚Äôt prompt again!
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>while
          True: try: x = int(input("What's x?")) except ValueError: print("x is
          not an integer") else: break print(f"x is {x}")
        </div>
        <p class="mt-4">
          Notice that while True will loop forever. If the user succeeds in
          supplying the correct input, we can break from the loop and then print
          the output. Now, a user that inputs something incorrectly will be
          asked for input again.
        </p>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-4">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-4"
            data-section-id="lec3-section-4"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-4" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-4">+10 XP</span>
        </div>
      </section>

      <!-- 5. Creating a Function to Get an Integer (verbatim text) -->
      <section class="reveal mb-12" data-section-id="lec3-section-5">
        <h2 class="text-2xl font-bold mb-3 flex items-center gap-2">
          <span>üîß</span> Creating a Function to Get an Integer
        </h2>
        <p class="mb-4">
          Surely, there are many times that we would want to get an integer from
          our user. Modify your code as follows:
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>def
          main(): x = get_int() print(f"x is {x}") def get_int(): while True:
          try: x = int(input("What's x?")) except ValueError: print("x is not an
          integer") else: break return x main()
        </div>
        <p class="mt-4">
          Notice that we are manifesting many great properties. First, we have
          abstracted away the ability to get an integer. Now, this whole program
          boils down to the first three lines of the program.
        </p>
        <p class="mt-4">
          Even still, we can improve this program. Consider what else you could
          do to improve this program. Modify your code as follows:
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>def
          main(): x = get_int() print(f"x is {x}") def get_int(): while True:
          try: x = int(input("What's x?")) except ValueError: print("x is not an
          integer") else: return x main()
        </div>
        <p class="mt-4">
          Notice that return will not only break you out of a loop, but it will
          also return a value.
        </p>
        <p class="mt-4">Some people may argue you could do the following:</p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>def
          main(): x = get_int() print(f"x is {x}") def get_int(): while True:
          try: return int(input("What's x?")) except ValueError: print("x is not
          an integer") main()
        </div>
        <p class="mt-4">
          Notice this does the same thing as the previous iteration of our code,
          simply with fewer lines.
        </p>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-5">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-5"
            data-section-id="lec3-section-5"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-5" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-5">+10 XP</span>
        </div>
      </section>

      <!-- 6. pass (verbatim text) -->
      <section class="reveal mb-12" data-section-id="lec3-section-6">
        <h2 class="text-2xl font-bold mb-3 flex items-center gap-2">
          <span>üöß</span> pass
        </h2>
        <p class="mb-4">
          We can make it such that our code does not warn our user, but simply
          re-asks them our prompting question by modifying our code as follows:
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>def
          main(): x = get_int() print(f"x is {x}") def get_int(): while True:
          try: return int(input("What's x?")) except ValueError: pass main()
        </div>
        <p class="mt-4">
          Notice that our code will still function but will not repeatedly
          inform the user of their error. In some cases, you‚Äôll want to be very
          clear to the user what error is being produced. Other times, you might
          decide that you simply want to ask them for input again.
        </p>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-6">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-6"
            data-section-id="lec3-section-6"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-6" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-6">+10 XP</span>
        </div>
      </section>

      <!-- 7. Final refinement (verbatim text) -->
      <section class="reveal mb-12" data-section-id="lec3-section-7">
        <h2 class="text-2xl font-bold mb-3 flex items-center gap-2">
          <span>üéÅ</span> One Final Refinement
        </h2>
        <p class="mb-4">
          One final refinement that could improve the implementation of this
          get_int function. Right now, notice that we are relying currently upon
          the honor system that the x is in both the main and get_int functions.
          We probably want to pass in a prompt that the user sees when asked for
          input. Modify your code as follows.
        </p>
        <div class="code-box">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>def
          main(): x = get_int("What's x? ") print(f"x is {x}") def
          get_int(prompt): while True: try: return int(input(prompt)) except
          ValueError: pass main()
        </div>
        <p class="mt-4">
          You can learn more in Python‚Äôs documentation of pass.
        </p>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-7">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-7"
            data-section-id="lec3-section-7"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-7" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-7">+10 XP</span>
        </div>
      </section>

      <!-- 8. live playground -->
      <section class="reveal mb-12" data-section-id="lec3-section-8">
        <h2 class="text-2xl font-bold mb-3 flex items-center gap-2">
          <span>üïπÔ∏è</span> Live Playground ‚Äì Break & Fix
        </h2>
        <textarea id="playground" class="code-box w-full h-48">
# Try typing "cat" or decimals when asked!
def get_int(prompt):
    while True:
        try:
            return int(input(prompt))
        except ValueError:
            pass   # silent retry

age = get_int("Age: ")
print(f"You are {age} years old.")
print("Thanks!")</textarea
        >
        <div class="flex items-center gap-3 mt-3">
          <button
            onclick="runCode()"
            class="px-5 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-700 transition"
          >
            ‚ñ∂ Run
          </button>
          <button
            onclick="resetCode()"
            class="px-5 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition"
          >
            Reset
          </button>
        </div>
        <div id="playground-out" class="output-box mt-3">
          Output will appear here‚Ä¶
        </div>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-8">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-8"
            data-section-id="lec3-section-8"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-8" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-8">+10 XP</span>
        </div>
      </section>

      <!-- 9. Summing Up (verbatim text) -->
      <section
        class="reveal mb-12 p-6 bg-gradient-to-r from-teal-50 to-blue-50 dark:from-teal-900/20 dark:to-blue-900/20 rounded-xl"
        data-section-id="lec3-section-9"
      >
        <h2 class="text-2xl font-bold mb-3">Summing Up</h2>
        <p>
          Errors are inevitable in your code. However, you have the opportunity
          to use what was learned today to help prevent these errors. In this
          lecture, you learned about‚Ä¶
        </p>
        <ul class="list-disc ml-6 space-y-1 mt-2">
          <li>Exceptions</li>
          <li>Value Errors</li>
          <li>Runtime Errors</li>
          <li><code>try</code></li>
          <li><code>else</code></li>
          <li><code>pass</code></li>
        </ul>

        <!-- Completion Checkbox -->
        <div class="section-complete" id="complete-lec3-section-9">
          <input
            type="checkbox"
            class="section-checkbox"
            id="checkbox-lec3-section-9"
            data-section-id="lec3-section-9"
            data-xp="10"
            onchange="handleSectionComplete(this)"
          />
          <label for="checkbox-lec3-section-9" class="section-checkbox-label">
            ‚úì I understand this topic
          </label>
          <span class="xp-badge" id="xp-badge-lec3-section-9">+10 XP</span>
        </div>
      </section>
    </main>
    <section class="reveal mt-12" data-section-id="lec3-section-10">
      <!-- neon-gradient title -->
      <h2
        class="text-4xl font-extrabold mb-10 text-center bg-clip-text text-transparent bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 drop-shadow-[0_0_10px_rgba(45,212,191,0.5)] dark:drop-shadow-[0_0_15px_rgba(94,234,212,0.6)]"
      >
        üéØ PSET 3 ‚Äì Exceptions, Files, CSV
      </h2>

      <!-- glowing card grid -->
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- 1. Fuel -->
        <div
          class="group relative bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-gray-900 dark:to-emerald-900/30 rounded-2xl p-6 shadow-xl dark:shadow-black/30 ring-1 ring-emerald-200 dark:ring-emerald-700 hover:ring-emerald-400 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-emerald-500/20"
        >
          <div
            class="absolute -top-3 -right-3 w-12 h-12 grid place-items-center rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 text-white font-bold shadow-lg drop-shadow-md"
          >
            1
          </div>
          <h3
            class="text-xl font-bold mb-3 text-emerald-700 dark:text-emerald-300"
          >
            Fuel
          </h3>
          <p class="text-sm mb-3 text-slate-700 dark:text-slate-300">
            Take "3/4" ‚Üí convert to 75%. If ‚â§1% print "E", if ‚â•99% print "F",
            else print XX%.
          </p>
          <div
            class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-100 dark:bg-emerald-800/30 text-emerald-700 dark:text-emerald-300 text-xs font-medium"
          >
            try/except + split + round
          </div>
          <p class="text-xs mt-3 text-slate-500 dark:text-slate-400">
            Hinglish: Fraction valid ho, warna dubara pucho. 1% se kam? Tank
            almost khali. 99% se zyada? Tank full. Simple.
          </p>
        </div>

        <!-- 2. Felipe‚Äôs Taqueria -->
        <div
          class="group relative bg-gradient-to-br from-cyan-50 to-blue-50 dark:from-gray-900 dark:to-cyan-900/30 rounded-2xl p-6 shadow-xl dark:shadow-black/40 ring-1 ring-cyan-200 dark:ring-cyan-700 hover:ring-cyan-400 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-cyan-500/20"
        >
          <div
            class="absolute -top-3 -right-3 w-12 h-12 grid place-items-center rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 text-white font-bold shadow-lg drop-shadow-md"
          >
            2
          </div>
          <h3 class="text-xl font-bold mb-3 text-cyan-700 dark:text-cyan-300">
            Felipe‚Äôs Taqueria
          </h3>
          <p class="text-sm mb-3 text-slate-700 dark:text-slate-300">
            Input a food item ‚Üí program prints its price. Case-insensitive, no
            errors if item not found.
          </p>
          <div
            class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-cyan-100 dark:bg-cyan-800/30 text-cyan-700 dark:text-cyan-300 text-xs font-medium"
          >
            dict + .lower() + no errors
          </div>
          <p class="text-xs mt-3 text-slate-500 dark:text-slate-400">
            Hinglish: Menu mein milta ho toh price batao, warna chup chap reh
            jao.
          </p>
        </div>

        <!-- 3. Grocery List -->
        <div
          class="group relative bg-gradient-to-br from-violet-50 to-purple-50 dark:from-gray-900 dark:to-violet-900/30 rounded-2xl p-6 shadow-xl dark:shadow-black/40 ring-1 ring-violet-200 dark:ring-violet-700 hover:ring-violet-400 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-violet-500/20"
        >
          <div
            class="absolute -top-3 -right-3 w-12 h-12 grid place-items-center rounded-full bg-gradient-to-br from-violet-500 to-purple-600 text-white font-bold shadow-lg drop-shadow-md"
          >
            3
          </div>
          <h3
            class="text-xl font-bold mb-3 text-violet-700 dark:text-violet-300"
          >
            Grocery List
          </h3>
          <p class="text-sm mb-3 text-slate-700 dark:text-slate-300">
            User enters items one per line. When Ctrl-D pressed ‚Üí print items
            alphabetically with quantities.
          </p>
          <div
            class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-violet-100 dark:bg-violet-800/30 text-violet-700 dark:text-violet-300 text-xs font-medium"
          >
            dict + EOFError + sort
          </div>
          <p class="text-xs mt-3 text-slate-500 dark:text-slate-400">
            Hinglish: User jab tak likhe, tab tak list banao. Ctrl+D aate hi
            totals dikha do.
          </p>
        </div>

        <!-- 4. Outdated -->
        <div
          class="group relative bg-gradient-to-br from-amber-50 to-orange-50 dark:from-gray-900 dark:to-amber-900/30 rounded-2xl p-6 shadow-xl dark:shadow-black/40 ring-1 ring-amber-200 dark:ring-amber-700 hover:ring-amber-400 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-amber-500/20"
        >
          <div
            class="absolute -top-3 -right-3 w-12 h-12 grid place-items-center rounded-full bg-gradient-to-br from-amber-500 to-orange-600 text-white font-bold shadow-lg drop-shadow-md"
          >
            4
          </div>
          <h3 class="text-xl font-bold mb-3 text-amber-700 dark:text-amber-300">
            Outdated
          </h3>
          <p class="text-sm mb-3 text-slate-700 dark:text-slate-300">
            Convert dates into YYYY-MM-DD format. Accepts "September 8, 2022" or
            "9/8/2022" ‚Üí output "2022-09-08".
          </p>
          <div
            class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-amber-100 dark:bg-amber-800/30 text-amber-700 dark:text-amber-300 text-xs font-medium"
          >
            split + month list + zero-pad
          </div>
          <p class="text-xs mt-3 text-slate-500 dark:text-slate-400">
            Hinglish: Date chahe slashes mein ho ya English mein, akhir mein ISO
            format chahiye. Month ka number dhundo, baaki pad do.
          </p>
        </div>

        <!-- 5. File Extensions -->
        <div
          class="group relative bg-gradient-to-br from-slate-50 to-gray-50 dark:from-gray-900 dark:to-slate-900/30 rounded-2xl p-6 shadow-xl dark:shadow-black/30 ring-1 ring-slate-200 dark:ring-slate-700 hover:ring-slate-400 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-slate-500/20 md:col-span-2 lg:col-span-1"
        >
          <div
            class="absolute -top-3 -right-3 w-12 h-12 grid place-items-center rounded-full bg-gradient-to-br from-slate-500 to-gray-600 text-white font-bold shadow-lg drop-shadow-md"
          >
            5
          </div>
          <h3 class="text-xl font-bold mb-3 text-slate-700 dark:text-slate-300">
            File Extensions
          </h3>
          <p class="text-sm mb-3 text-slate-700 dark:text-slate-300">
            Input a filename ‚Üí print its MIME type. cat.png ‚Üí "image/png",
            unknown ‚Üí "application/octet-stream".
          </p>
          <div
            class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800/30 text-slate-700 dark:text-slate-300 text-xs font-medium"
          >
            .lower() + rsplit + dict
          </div>
          <p class="text-xs mt-3 text-slate-500 dark:text-slate-400">
            Hinglish: Bas file ka extension pakdo. Agar famous extension hua toh
            MIME type batao, warna ‚Äúoctet-stream‚Äù bhej do.
          </p>
        </div>
      </div>

      <!-- flashy summary row -->
      <div
        class="mt-10 p-5 bg-gradient-to-r from-emerald-500/10 via-teal-500/10 to-cyan-500/10 dark:from-emerald-500/20 dark:via-teal-500/20 dark:to-cyan-500/20 rounded-2xl border border-emerald-300 dark:border-emerald-700 text-center"
      >
        <p class="font-bold text-slate-800 dark:text-slate-200">
          üî• Quick Memory Trigger
        </p>
        <p class="text-sm mt-2 text-slate-600 dark:text-slate-300">
          Fuel ‚Üí fraction ‚Üí % | Taqueria ‚Üí dict lookup | Grocery ‚Üí EOF counter |
          Outdated ‚Üí any‚ÜíISO | Extensions ‚Üí ext‚ÜíMIME
        </p>
      </div>

      <!-- Completion Checkbox -->
      <div class="section-complete" id="complete-lec3-section-10">
        <input
          type="checkbox"
          class="section-checkbox"
          id="checkbox-lec3-section-10"
          data-section-id="lec3-section-10"
          data-xp="10"
          onchange="handleSectionComplete(this)"
        />
        <label for="checkbox-lec3-section-10" class="section-checkbox-label">
          ‚úì I understand this topic
        </label>
        <span class="xp-badge" id="xp-badge-lec3-section-10">+10 XP</span>
      </div>
    </section>
    <footer class="bg-gray-900 text-white py-8 mt-12">
      <div class="max-w-4xl mx-auto px-4 text-center text-gray-400">
        ¬© 2024 PythonLearn ‚Äì built with ‚ù§Ô∏è for every future Pythonista.
      </div>
    </footer>

    <!-- =========  TEXT-TO-SPEECH PANEL  ========= -->
    <div class="tts-container" id="ttsContainer">
      <div class="tts-header" onclick="toggleTTS()">
        <div class="tts-title">
          <span>üîä</span>
          <span>Text to Speech</span>
        </div>
        <button
          class="tts-btn secondary"
          style="padding: 4px 8px; font-size: 12px"
        >
          <span id="ttsToggleIcon">‚àí</span>
        </button>
      </div>
      <div id="ttsControls">
        <div class="tts-controls">
          <button class="tts-btn" id="ttsPlayBtn" onclick="playSelectedText()">
            <span>‚ñ∂</span> Read Selected
          </button>
          <button
            class="tts-btn secondary"
            id="ttsSectionBtn"
            onclick="readCurrentSection()"
          >
            <span>üìñ</span> Read Section
          </button>
          <button
            class="tts-btn secondary"
            id="ttsStopBtn"
            onclick="stopTTS()"
            disabled
          >
            <span>‚èπ</span> Stop
          </button>
        </div>
        <div class="tts-speed-control">
          <span>Speed:</span>
          <input
            type="range"
            min="0.5"
            max="2"
            step="0.1"
            value="1"
            class="tts-speed-slider"
            id="ttsSpeedSlider"
          />
          <span id="ttsSpeedValue">1.0x</span>
        </div>
        <div class="tts-status" id="ttsStatus">
          Select text or click "Read Section"
        </div>
      </div>
    </div>

    <script>
      /* dark mode */
      if (
        localStorage.theme === "dark" ||
        (!("theme" in localStorage) &&
          window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
      /* scroll reveal */
      const reveals = document.querySelectorAll(".reveal");
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              anime({
                targets: entry.target,
                opacity: 1,
                translateY: 0,
                duration: 600,
                easing: "easeOutQuad",
              });
              observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.15 }
      );
      reveals.forEach((el) => observer.observe(el));

      /* copy code */
      function copyCode(btn) {
        const box = btn.parentElement;
        const code = box.textContent.trim();
        navigator.clipboard.writeText(code);
        btn.textContent = "Copied!";
        setTimeout(() => (btn.textContent = "Copy"), 1200);
      }

      /* Skulpt runner */
      function outf(text) {
        document.getElementById("playground-out").textContent += text;
      }
      function builtinRead(x) {
        if (
          Sk.builtinFiles === undefined ||
          Sk.builtinFiles["files"][x] === undefined
        )
          throw new Error("File not found: " + x);
        return Sk.builtinFiles["files"][x];
      }
      function runCode() {
        const prog = document.getElementById("playground").value;
        document.getElementById("playground-out").textContent = "";
        Sk.pre = "playground-out";
        Sk.configure({
          output: outf,
          read: builtinRead,
          __future__: Sk.python3,
        });
        const myPromise = Sk.misceval.asyncToPromise(() =>
          Sk.importMainWithBody("<stdin>", false, prog, true)
        );
        myPromise.then(
          () => {},
          (err) =>
            (document.getElementById("playground-out").textContent =
              err.toString())
        );
      }
      function resetCode() {
        document.getElementById("playground").value = `def get_int(prompt):
    while True:
        try:
            return int(input(prompt))
        except ValueError:
            pass   # silent retry

age = get_int("Age: ")
print(f"You are {age} years old.")
print("Thanks!")`;
        document.getElementById("playground-out").textContent =
          "Output will appear here‚Ä¶";
      }

      /* highlight current lecture */
      document.querySelectorAll(".mini-nav a").forEach((a) => {
        if (a.href.endsWith("lec3.html"))
          a.classList.add("bg-teal-700", "text-white");
      });

      /* =========  TEXT-TO-SPEECH FUNCTIONALITY  ========= */
      let synth = window.speechSynthesis;
      let currentUtterance = null;
      let isReading = false;
      let currentHighlight = null;

      function toggleTTS() {
        const container = document.getElementById("ttsContainer");
        const controls = document.getElementById("ttsControls");
        const icon = document.getElementById("ttsToggleIcon");

        if (container.classList.contains("collapsed")) {
          container.classList.remove("collapsed");
          controls.style.display = "block";
          icon.textContent = "‚àí";
        } else {
          container.classList.add("collapsed");
          controls.style.display = "none";
          icon.textContent = "+";
        }
      }

      function getSelectedText() {
        const selection = window.getSelection();
        return selection.toString().trim();
      }

      function removeHighlights() {
        if (currentHighlight) {
          currentHighlight.classList.remove("tts-reading");
          currentHighlight = null;
        }
        document.querySelectorAll(".tts-reading").forEach((el) => {
          el.classList.remove("tts-reading");
        });
      }

      function speakText(text, element = null) {
        if (!text) {
          updateStatus("No text selected");
          return;
        }

        stopTTS();

        const cleanText = text
          .replace(/<[^>]*>/g, "")
          .replace(/\s+/g, " ")
          .trim();

        if (!cleanText) {
          updateStatus("No readable text found");
          return;
        }

        currentUtterance = new SpeechSynthesisUtterance(cleanText);
        const speed = parseFloat(
          document.getElementById("ttsSpeedSlider").value
        );
        currentUtterance.rate = speed;
        currentUtterance.pitch = 1;
        currentUtterance.volume = 1;

        if (element) {
          removeHighlights();
          element.classList.add("tts-reading");
          currentHighlight = element;
          element.scrollIntoView({ behavior: "smooth", block: "center" });
        }

        currentUtterance.onstart = () => {
          isReading = true;
          updateButtons(true);
          updateStatus("Reading...");
        };

        currentUtterance.onend = () => {
          isReading = false;
          updateButtons(false);
          removeHighlights();
          updateStatus("Finished reading");
          setTimeout(
            () => updateStatus('Select text or click "Read Section"'),
            2000
          );
        };

        currentUtterance.onerror = (event) => {
          isReading = false;
          updateButtons(false);
          removeHighlights();
          updateStatus("Error: " + event.error);
        };

        synth.speak(currentUtterance);
      }

      function playSelectedText() {
        const selectedText = getSelectedText();
        if (selectedText) {
          speakText(selectedText);
          updateStatus("Reading selected text...");
        } else {
          updateStatus("Please select some text first");
          readCurrentSection();
        }
      }

      function readCurrentSection() {
        const sections = document.querySelectorAll("section.reveal");
        let targetSection = null;

        sections.forEach((section) => {
          const rect = section.getBoundingClientRect();
          if (rect.top >= 0 && rect.top <= window.innerHeight / 2) {
            targetSection = section;
          }
        });

        if (!targetSection && sections.length > 0) {
          targetSection = sections[0];
        }

        if (targetSection) {
          const codeBoxes = targetSection.querySelectorAll(
            ".code-box, .output-box"
          );
          codeBoxes.forEach((box) => (box.style.display = "none"));

          const text = targetSection.innerText || targetSection.textContent;

          codeBoxes.forEach((box) => (box.style.display = ""));

          if (text) {
            speakText(text, targetSection);
            updateStatus(
              "Reading section: " +
                (targetSection.querySelector("h2")?.textContent || "Section")
            );
          } else {
            updateStatus("No text found in section");
          }
        } else {
          updateStatus("No section found");
        }
      }

      function stopTTS() {
        if (synth.speaking) {
          synth.cancel();
        }
        isReading = false;
        updateButtons(false);
        removeHighlights();
        updateStatus("Stopped");
        setTimeout(
          () => updateStatus('Select text or click "Read Section"'),
          2000
        );
      }

      function updateButtons(reading) {
        document.getElementById("ttsPlayBtn").disabled = reading;
        document.getElementById("ttsSectionBtn").disabled = reading;
        document.getElementById("ttsStopBtn").disabled = !reading;
      }

      function updateStatus(message) {
        document.getElementById("ttsStatus").textContent = message;
      }

      document
        .getElementById("ttsSpeedSlider")
        .addEventListener("input", function (e) {
          const speed = parseFloat(e.target.value);
          document.getElementById("ttsSpeedValue").textContent =
            speed.toFixed(1) + "x";
          if (currentUtterance && isReading) {
            synth.cancel();
            currentUtterance.rate = speed;
            synth.speak(currentUtterance);
          }
        });

      window.addEventListener("beforeunload", () => {
        stopTTS();
      });

      document.addEventListener("dblclick", function (e) {
        if (e.target.tagName === "P" || e.target.closest("p")) {
          const paragraph =
            e.target.tagName === "P" ? e.target : e.target.closest("p");
          const text = paragraph.innerText || paragraph.textContent;
          if (text.trim()) {
            speakText(text, paragraph);
          }
        }
      });
    </script>
    \n
    <script>
      \n
              /* ----- dark mode toggle (respects your nav) ----- */
              if (
                localStorage.theme === "dark" ||
                (!("theme" in localStorage) &&
                  window.matchMedia("(prefers-color-scheme: dark)").matches)
              ) {
                document.documentElement.setAttribute("data-theme", "dark");
              } else {
                document.documentElement.setAttribute("data-theme", "light");
              }

              /* ----- scroll reveal ----- */
              const reveals = document.querySelectorAll(".reveal");
              const observer = new IntersectionObserver(
                (entries) => {
                  entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                      anime({
                        targets: entry.target,
                        opacity: 1,
                        translateY: 0,
                        duration: 600,
                        easing: "easeOutQuad",
                      });
                      observer.unobserve(entry.target);
                    }
                  });
                },
                { threshold: 0.15 }
              );
              reveals.forEach((el) => observer.observe(el));

              /* ----- copy code ----- */
              function copyCode(btn) {
                const box = btn.parentElement;
                const code = box.textContent.trim();
                navigator.clipboard.writeText(code);
                btn.textContent = "Copied!";
                setTimeout(() => (btn.textContent = "Copy"), 1200);
              }

              /* ----- live runner (Skulpt) ----- */
              function outf(text) {
                const out = document.getElementById("playground-out");
                out.textContent += text;
              }
              function builtinRead(x) {
                if (
                  Sk.builtinFiles === undefined ||
                  Sk.builtinFiles["files"][x] === undefined
                )
                  throw new Error("File not found: " + x);
                return Sk.builtinFiles["files"][x];
              }
              function runCode() {
                const prog = document.getElementById("playground").value;
                document.getElementById("playground-out").textContent = "";
                Sk.pre = "playground-out";
                Sk.configure({
                  output: outf,
                  read: builtinRead,
                  __future__: Sk.python3,
                });
                (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target =
                  "playground-out";
                const myPromise = Sk.misceval.asyncToPromise(() =>
                  Sk.importMainWithBody("<stdin>", false, prog, true)
                );
                myPromise.then(
                  () => {
                    const out = document.getElementById("playground-out").textContent;
                    if (out.includes("¬∞F") || out.includes("¬∞C")) {
                      const cel = document.getElementById("celebrate");
                      cel.classList.remove("hidden");
                      cel.querySelector("span").classList.add("check-celebration");
                    }
                  },
                  (err) => {
                    document.getElementById("playground-out").textContent =
                      err.toString();
                  }
                );
              }
              function resetCode() {
                document.getElementById(
                  "playground"
                ).value = `name = input("What's your name? ")
      print(f"hello, {name}")`;
                document.getElementById("playground-out").textContent =
                  "Output will appear here‚Ä¶";
              }

              /* highlight current lecture */
              document.querySelectorAll(".lecture2-nav a").forEach((a) => {
                if (a.href.endsWith("lec0.html"))
                  a.classList.add("bg-teal-700", "text-white");
              });

              /* =========  TEXT-TO-SPEECH FUNCTIONALITY  ========= */
              let synth = window.speechSynthesis;
              let currentUtterance = null;
              let isReading = false;
              let currentHighlight = null;

              // Toggle TTS panel
              function toggleTTS() {
                const container = document.getElementById("ttsContainer");
                const controls = document.getElementById("ttsControls");
                const icon = document.getElementById("ttsToggleIcon");

                if (container.classList.contains("collapsed")) {
                  container.classList.remove("collapsed");
                  controls.style.display = "block";
                  icon.textContent = "‚àí";
                } else {
                  container.classList.add("collapsed");
                  controls.style.display = "none";
                  icon.textContent = "+";
                }
              }

              // Get selected text
              function getSelectedText() {
                const selection = window.getSelection();
                return selection.toString().trim();
              }

              // Remove previous highlights
              function removeHighlights() {
                if (currentHighlight) {
                  currentHighlight.classList.remove("tts-reading");
                  currentHighlight = null;
                }
                document.querySelectorAll(".tts-reading").forEach((el) => {
                  el.classList.remove("tts-reading");
                });
              }

              // Speak text
              function speakText(text, element = null) {
                if (!text) {
                  updateStatus("No text selected");
                  return;
                }

                // Stop any current speech
                stopTTS();

                // Remove HTML tags and clean text
                const cleanText = text
                  .replace(/<[^>]*>/g, "")
                  .replace(/\s+/g, " ")
                  .trim();

                if (!cleanText) {
                  updateStatus("No readable text found");
                  return;
                }

                // Create utterance
                currentUtterance = new SpeechSynthesisUtterance(cleanText);
                const speed = parseFloat(
                  document.getElementById("ttsSpeedSlider").value
                );
                currentUtterance.rate = speed;
                currentUtterance.pitch = 1;
                currentUtterance.volume = 1;

                // Highlight element being read
                if (element) {
                  removeHighlights();
                  element.classList.add("tts-reading");
                  currentHighlight = element;

                  // Scroll to element
                  element.scrollIntoView({ behavior: "smooth", block: "center" });
                }

                // Event handlers
                currentUtterance.onstart = () => {
                  isReading = true;
                  updateButtons(true);
                  updateStatus("Reading...");
                };

                currentUtterance.onend = () => {
                  isReading = false;
                  updateButtons(false);
                  removeHighlights();
                  updateStatus("Finished reading");
                  setTimeout(
                    () => updateStatus('Select text or click "Read Section"'),
                    2000
                  );
                };

                currentUtterance.onerror = (event) => {
                  isReading = false;
                  updateButtons(false);
                  removeHighlights();
                  updateStatus("Error: " + event.error);
                };

                // Speak
                synth.speak(currentUtterance);
              }

              // Play selected text
              function playSelectedText() {
                const selectedText = getSelectedText();
                if (selectedText) {
                  speakText(selectedText);
                  updateStatus("Reading selected text...");
                } else {
                  updateStatus("Please select some text first");
                  // Try to read the current section if nothing is selected
                  readCurrentSection();
                }
              }

              // Read current section (section in viewport)
              function readCurrentSection() {
                const sections = document.querySelectorAll("section.reveal");
                let targetSection = null;

                // Find the section currently in viewport
                sections.forEach((section) => {
                  const rect = section.getBoundingClientRect();
                  if (rect.top >= 0 && rect.top <= window.innerHeight / 2) {
                    targetSection = section;
                  }
                });

                // If no section in viewport, use the first one
                if (!targetSection && sections.length > 0) {
                  targetSection = sections[0];
                }

                if (targetSection) {
                  // Get all text from section (excluding code blocks)
                  const codeBoxes = targetSection.querySelectorAll(
                    ".code-box, .output-box"
                  );
                  codeBoxes.forEach((box) => (box.style.display = "none"));

                  const text = targetSection.innerText || targetSection.textContent;

                  codeBoxes.forEach((box) => (box.style.display = ""));

                  if (text) {
                    speakText(text, targetSection);
                    updateStatus(
                      "Reading section: " +
                        (targetSection.querySelector("h2")?.textContent || "Section")
                    );
                  } else {
                    updateStatus("No text found in section");
                  }
                } else {
                  updateStatus("No section found");
                }
              }

              // Stop TTS
              function stopTTS() {
                if (synth.speaking) {
                  synth.cancel();
                }
                isReading = false;
                updateButtons(false);
                removeHighlights();
                updateStatus("Stopped");
                setTimeout(
                  () => updateStatus('Select text or click "Read Section"'),
                  2000
                );
              }

              // Update button states
              function updateButtons(reading) {
                document.getElementById("ttsPlayBtn").disabled = reading;
                document.getElementById("ttsSectionBtn").disabled = reading;
                document.getElementById("ttsStopBtn").disabled = !reading;
              }

              // Update status message
              function updateStatus(message) {
                document.getElementById("ttsStatus").textContent = message;
              }

              // Speed slider update
              document
                .getElementById("ttsSpeedSlider")
                .addEventListener("input", function (e) {
                  const speed = parseFloat(e.target.value);
                  document.getElementById("ttsSpeedValue").textContent =
                    speed.toFixed(1) + "x";
                  if (currentUtterance && isReading) {
                    synth.cancel();
                    currentUtterance.rate = speed;
                    synth.speak(currentUtterance);
                  }
                });

              // Stop on page unload
              window.addEventListener("beforeunload", () => {
                stopTTS();
              });

              // Double-click to read paragraph
              document.addEventListener("dblclick", function (e) {
                if (e.target.tagName === "P" || e.target.closest("p")) {
                  const paragraph =
                    e.target.tagName === "P" ? e.target : e.target.closest("p");
                  const text = paragraph.innerText || paragraph.textContent;
                  if (text.trim()) {
                    speakText(text, paragraph);
                  }
                }
              });

              /* =========  XP & LEVEL SYSTEM  ========= */
              // XP and Level Management
              const XP_SYSTEM = {
                // XP required for each level (exponential growth)
                getXPForLevel: (level) => {
                  return Math.floor(100 * Math.pow(1.5, level - 1));
                },

                // Calculate level from total XP
                getLevelFromXP: (totalXP) => {
                  let level = 1;
                  let xpNeeded = 0;
                  while (xpNeeded <= totalXP) {
                    xpNeeded += XP_SYSTEM.getXPForLevel(level);
                    if (xpNeeded <= totalXP) {
                      level++;
                    }
                  }
                  return level;
                },

                // Get XP progress for current level
                getXPProgress: (totalXP, level) => {
                  let xpForCurrentLevel = 0;
                  for (let i = 1; i < level; i++) {
                    xpForCurrentLevel += XP_SYSTEM.getXPForLevel(i);
                  }
                  const currentLevelXP = totalXP - xpForCurrentLevel;
                  const xpNeededForLevel = XP_SYSTEM.getXPForLevel(level);
                  return {
                    current: currentLevelXP,
                    needed: xpNeededForLevel,
                    percentage: Math.min(
                      100,
                      (currentLevelXP / xpNeededForLevel) * 100
                    ),
                  };
                },

                // Initialize user data
                init: () => {
                  let userData = JSON.parse(
                    localStorage.getItem("pythonLearnUserData") || "{}"
                  );
                  if (!userData.xp) userData.xp = 0;
                  if (!userData.completedSections) userData.completedSections = [];
                  if (!userData.completedQuizzes) userData.completedQuizzes = [];
                  localStorage.setItem(
                    "pythonLearnUserData",
                    JSON.stringify(userData)
                  );
                  return userData;
                },

                // Add XP
                addXP: (amount, source) => {
                  const userData = XP_SYSTEM.init();
                  const oldLevel = XP_SYSTEM.getLevelFromXP(userData.xp);
                  userData.xp += amount;
                  const newLevel = XP_SYSTEM.getLevelFromXP(userData.xp);

                  localStorage.setItem(
                    "pythonLearnUserData",
                    JSON.stringify(userData)
                  );

                  // Check for level up
                  if (newLevel > oldLevel) {
                    XP_SYSTEM.showLevelUp(newLevel);
                  }

                  XP_SYSTEM.updateDisplay();
                  return {
                    xp: userData.xp,
                    level: newLevel,
                    leveledUp: newLevel > oldLevel,
                  };
                },

                // Show level up animation
                showLevelUp: (level) => {
                  const levelUpModal = document.createElement("div");
                  levelUpModal.className = "level-up-modal";
                  levelUpModal.innerHTML = `
                    <div class="level-up-content">
                      <div class="level-up-icon">üéâ</div>
                      <h2>Level Up!</h2>
                      <p class="level-up-text">You've reached Level ${level}!</p>
                      <p class="level-up-subtext">Keep learning to unlock more levels!</p>
                      <button onclick="this.closest('.level-up-modal').remove()" class="level-up-btn">Awesome!</button>
                    </div>
                  `;
                  document.body.appendChild(levelUpModal);
                  setTimeout(() => levelUpModal.classList.add("show"), 100);
                },

                // Update XP and Level display
                updateDisplay: () => {
                  const userData = XP_SYSTEM.init();
                  const level = XP_SYSTEM.getLevelFromXP(userData.xp);
                  const progress = XP_SYSTEM.getXPProgress(userData.xp, level);

                  // Update nav display
                  const xpDisplay = document.getElementById("user-xp-display");
                  const levelDisplay = document.getElementById("user-level-display");

                  if (xpDisplay) {
                    xpDisplay.textContent = `XP: ${userData.xp}`;
                  }
                  if (levelDisplay) {
                    levelDisplay.textContent = `Level ${level}`;
                  }
                },

                // Load completed sections
                loadCompletedSections: () => {
                  const userData = XP_SYSTEM.init();
                  if (userData.completedSections) {
                    userData.completedSections.forEach((sectionId) => {
                      const checkbox = document.getElementById(
                        `checkbox-${sectionId}`
                      );
                      const completeDiv = document.getElementById(
                        `complete-${sectionId}`
                      );
                      if (checkbox) {
                        checkbox.checked = true;
                        if (completeDiv) {
                          completeDiv.classList.add("completed");
                        }
                      }
                    });
                  }
                },
              };

              // Handle section completion
              function handleSectionComplete(checkbox) {
                const sectionId = checkbox.dataset.sectionId;
                const xpAmount = parseInt(checkbox.dataset.xp || 10);
                const completeDiv = document.getElementById(`complete-${sectionId}`);
                const xpBadge = document.getElementById(`xp-badge-${sectionId}`);

                if (checkbox.checked) {
                  // Mark as completed
                  if (completeDiv) {
                    completeDiv.classList.add("completed");
                  }

                  // Add XP
                  const result = XP_SYSTEM.addXP(xpAmount, "section");

                  // Update user data
                  const userData = XP_SYSTEM.init();
                  if (!userData.completedSections.includes(sectionId)) {
                    userData.completedSections.push(sectionId);
                    localStorage.setItem(
                      "pythonLearnUserData",
                      JSON.stringify(userData)
                    );

                    // Show XP animation
                    if (xpBadge) {
                      xpBadge.classList.add("earned");
                      setTimeout(() => xpBadge.classList.remove("earned"), 500);
                    }

                    // Show notification
                    showXPNotification(`+${xpAmount} XP`, result.leveledUp);
                  }
                } else {
                  // Uncheck - remove XP (optional, or keep it)
                  if (completeDiv) {
                    completeDiv.classList.remove("completed");
                  }

                  // Remove from completed sections
                  const userData = XP_SYSTEM.init();
                  userData.completedSections = userData.completedSections.filter(
                    (id) => id !== sectionId
                  );
                  localStorage.setItem(
                    "pythonLearnUserData",
                    JSON.stringify(userData)
                  );
                }
              }

              // Show XP notification
              function showXPNotification(message, leveledUp = false) {
                const notification = document.createElement("div");
                notification.className = "xp-notification";
                notification.textContent = message;
                if (leveledUp) {
                  notification.classList.add("level-up");
                }
                document.body.appendChild(notification);
                setTimeout(() => notification.classList.add("show"), 100);
                setTimeout(() => {
                  notification.classList.remove("show");
                  setTimeout(() => notification.remove(), 300);
                }, 2000);
              }

              // Initialize on page load
              document.addEventListener("DOMContentLoaded", () => {
                XP_SYSTEM.updateDisplay();
                XP_SYSTEM.loadCompletedSections();
              });
            \n
    </script>
    \n
  </body>
</html>
